webpackJsonp([38],{R71s:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("oVOW"),o={name:"Power",data:function(){return{filters:{column:{create_start_date:"",create_end_date:""}},rollArr1:[],rollArr2:[],rollArr:[],mark1:[],mark2:[],mark:[],startDate:"",id:"",endDate:"",gongNeng:[],content:[],multipleSelection:[],data2:[],data3:[],flag:!0,pickerBeginDateBefore:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},pickerBeginDateAfter:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},funcList:[],filterText:"",libaryData1:[],libaryData2:[],libaryData3:[],defaultProps:{label:"label",children:"children",isLeaf:"leaf"},resolve:null}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{monitorActivate:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];for(e=0;e<8;e++)r[e]=t[0|Math.random()*t.length];var a=r.join("");_BFD.UserAction("add_partySchool",{uid:a,partyschool_name:this.$route.query.partyschoolName,start_date:this.filters.column.create_start_date,end_date:this.filters.column.create_end_date})},demo:function(){this.id=this.$route.query.reportID},search1:function(){var e=this;a.b({partyschoolId:this.id,type:"2",resourcesType:"2",sourceType:"1"}).then(function(t){if(200===t.code){e.data3=t.result;var r=[];e.rollArr2=[],e.data3.forEach(function(t){t.children.length&&t.children.forEach(function(t){t.mark&&(r.push(t.id),e.rollArr2.push({authorizationId:t.id,type:"2"}),e.rollArr=e.rollArr1.concat(e.rollArr2))})})}e.content=r})},getData:function(){var e=this;a.b({partyschoolId:this.id,type:"2",resourcesType:"2",sourceType:"1"}).then(function(t){e.data3=t.result})},handleSelectionChange:function(e,t){var r=this;this.rollArr1=[],t.halfCheckedKeys.length&&t.halfCheckedKeys.forEach(function(e){var t={};t.authorizationId=e,t.type=1,r.rollArr1.push(t)}),t.checkedNodes.forEach(function(e){var t={};t.authorizationId=e.id,t.type=1,r.rollArr1.push(t)}),this.rollArr=this.rollArr1.concat(this.rollArr2)},handleCheck:function(e,t){var r=this;this.rollArr2=[],t.checkedNodes.forEach(function(e){var t={};t.authorizationId=e.id,t.type=2,r.rollArr2.push(t)}),this.rollArr=this.rollArr1.concat(this.rollArr2)},search:function(){var e=this;a.b({partyschoolId:this.id,type:"1",resourcesType:"1",sourceType:""}).then(function(t){if(200===t.code){e.data2=t.result,e.filters.column.create_start_date=t.result[0].startDate,e.filters.column.create_end_date=t.result[0].endDate;var r=[],a=[];e.data2.forEach(function(e){e.children.length&&e.children.forEach(function(e){e.mark&&r.push(e.id)})}),e.data2.forEach(function(e){e.children.length||e.mark&&a.push(e.id)}),e.gongNeng=r.concat(a),e.rollArr1=[],e.gongNeng.forEach(function(t){e.rollArr1.push({authorizationId:t,type:"1"})}),e.rollArr=e.rollArr1.concat(e.rollArr2)}})},powerSubmit:function(){var e=this;this.filters.column.create_start_date&&this.filters.column.create_end_date?this.flag&&(this.flag=!1,a.j({data:this.rollArr,partyschoolId:this.id,startDate:this.filters.column.create_start_date,endDate:this.filters.column.create_end_date}).then(function(t){200===t.code?(e.$router.push("empower"),e.$message({message:"授权成功!",type:"success"}),e.monitorActivate(),e.flag=!0):e.$message({message:"授权失败!",type:"warning"})})):this.$message({message:"请输入授权期限",type:"warning"})},goBack:function(){this.$router.go(-1)},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},resetChecked:function(){this.$refs.trees.setCheckedKeys([]),this.rollArr1=[],this.rollArr=this.rollArr1.concat(this.rollArr2)},resetCheckedAll:function(){var e=this;a.b({partyschoolId:this.id,type:"1",resourcesType:"1",sourceType:""}).then(function(t){var r=[],a=[],o=[];t.result.forEach(function(e){var t={};r.push(e.id),t.authorizationId=e.id,t.type=1,a.push(t)}),t.result.forEach(function(e){e.children.length&&e.children.forEach(function(e){var t={};t.authorizationId=e.id,t.type=1,o.push(t)})}),e.rollArr1=a.concat(o),e.rollArr=e.rollArr1.concat(e.rollArr2),e.$refs.trees.setCheckedKeys(r)})}},components:{commonBread:r("Osha").a},created:function(){this.demo(),this.getData(),this.search(),this.search1()}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"powerBor"},[r("div",{staticClass:"crumbs"},[r("common-bread")],1),e._v(" "),r("div",{staticClass:"user"},[r("p",{staticClass:"titleBar"},[e._v("\n      党校授权\n    ")]),e._v(" "),r("div",{staticClass:"during"},[r("el-form",{ref:"form",staticStyle:{color:"#999999"},attrs:{"label-width":"80px"}},[r("el-form-item",{staticStyle:{display:"inline-block",color:"#999999"},attrs:{label:"授权期限 : "}},[r("el-date-picker",{attrs:{"value-format":" yyyy-MM-dd",id:"date1",type:"date",size:"small","picker-options":e.pickerBeginDateBefore,format:"yyyy-MM-dd"},on:{change:function(t){e.filters.column.create_start_date=t}},model:{value:e.filters.column.create_start_date,callback:function(t){e.$set(e.filters.column,"create_start_date",t)},expression:"filters.column.create_start_date"}})],1),e._v(" "),r("el-form-item",{staticStyle:{display:"inline-block",color:"#999999"},attrs:{label:"至","label-width":"25px"}},[r("el-date-picker",{attrs:{"value-format":" yyyy-MM-dd",id:"date2",type:"date",size:"small",format:"yyyy-MM-dd","picker-options":e.pickerBeginDateAfter},on:{change:function(t){e.filters.column.create_end_date=t}},model:{value:e.filters.column.create_end_date,callback:function(t){e.$set(e.filters.column,"create_end_date",t)},expression:"filters.column.create_end_date"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"function"},[e._m(0),e._v(" "),r("div",{staticClass:"anNiu"},[r("el-button",{attrs:{round:"",type:"primary",id:"quanxuan"},on:{click:e.resetCheckedAll}},[e._v("全选")]),e._v(" "),r("el-button",{attrs:{round:"",id:"quanxuan"},on:{click:e.resetChecked}},[e._v("清空")])],1),e._v(" "),r("div",{attrs:{id:"tree"}},[r("el-tree",{ref:"trees",attrs:{data:e.data2,"show-checkbox":"","node-key":"id","default-checked-keys":e.gongNeng,props:e.defaultProps},on:{check:e.handleSelectionChange}})],1)]),e._v(" "),r("div",{staticClass:"content"},[r("h3",[e._v("内容资源 :")]),e._v(" "),r("div",{staticClass:"treeBor"},[r("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),r("el-tree",{ref:"tree",attrs:{data:e.data3,"show-checkbox":"","node-key":"id","default-checked-keys":e.content,props:e.defaultProps,"filter-node-method":e.filterNode},on:{check:e.handleCheck}})],1)]),e._v(" "),r("div",{staticClass:"submit"},[r("button",{on:{click:e.powerSubmit}},[e._v("授 权")]),e._v(" "),r("button",{on:{click:e.goBack}},[e._v("取 消")])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[this._v("功"),t("span",{staticStyle:{display:"inline-block",width:"30px"}}),this._v("能 :")])}]};var n=r("C7Lr")(o,i,!1,function(e){r("wx+m")},"data-v-3d8ba340",null);t.default=n.exports},"wx+m":function(e,t){}});
//# sourceMappingURL=38.d1e0f7b375dcecc9d131.js.map