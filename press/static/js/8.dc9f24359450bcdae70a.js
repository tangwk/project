webpackJsonp([8],{Mdnr:function(e,t,n){"use strict";var a=n("JVB/");var r={getWeChatList:function(e){return Object(a.a)({url:"/findWechatAccount",method:"post",data:e})},deleteMenu:function(e){return Object(a.a)({url:"/deleteMenu",method:"post",data:e})},addMenu:function(e){return Object(a.a)({url:"/saveMenu",method:"post",data:e})},getMenuList:function(e){return Object(a.a)({url:"/findWechatMenuByPartyschoolId",method:"post",data:e})},getParentMenu:function(e){return Object(a.a)({url:"/findParentMenu",method:"post",data:e})},getMenuUrl:function(e){return Object(a.a)({url:"/findWechatMenuUrl",method:"post",data:e})},saveNewMenu:function(e){return Object(a.a)({url:"/saveWechatMenu",method:"post",data:e})},pushMenu:function(e){return Object(a.a)({url:"/pushMenu",method:"post",data:e})},resetMenu:function(e){return Object(a.a)({url:"/deleteMenu",method:"post",data:e})},deleteMenuData:function(e){return Object(a.a)({url:"/deleteWechatMenu",method:"post",data:e})}};t.a=r},T3Dc:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Osha"),r=n("Mdnr"),o={name:"WeMenu",data:function(){return{form:{menuParent:"",menuName:"",menuUrl:""},flag:!1,menuData:[],parentOptions:[],options:[]}},methods:{search:function(){var e=this;this.menuData=[],r.a.getMenuList({partyschoolId:this.reportID}).then(function(t){var n=t.result;900!==t.code&&(n.forEach(function(e){e.firstMenu=e.parentName,e.children[0]?e.oneMenu=e.children[0].menuName:e.oneMenu="",e.children[1]?e.twoMenu=e.children[1].menuName:e.twoMenu="",e.children[2]?e.threeMenu=e.children[2].menuName:e.threeMenu="",e.children[3]?e.fourMenu=e.children[3].menuName:e.fourMenu="",e.children[4]?e.fiveMenu=e.children[4].menuName:e.fiveMenu=""}),e.menuData=n)})},save:function(e){var t=this;this.$validator.validateAll().then(function(e){e&&r.a.saveNewMenu({partyschoolId:t.reportID,parentId:t.form.menuParent,menuType:"2",menuName:t.form.menuName,urlId:t.form.menuUrl}).then(function(e){t.$message({message:"保存成功！",type:"success"}),t.form.menuParent="",t.form.menuName="",t.form.menuUrl="",t.$validator.reset(),t.getParentMenu(),t.search()})})},onSubmit:function(){var e=this;this.flag=!1,this.menuData.forEach(function(t){t.children.length<=0&&(e.$message({message:"请选择二级菜单",type:"warning"}),e.flag=!0)}),this.flag||r.a.pushMenu({partyschoolId:this.reportID}).then(function(t){200===t.code&&e.$message({message:"发布成功",type:"success"})})},reset:function(){var e=this;r.a.resetMenu({partyschoolId:this.reportID}).then(function(t){200===t.code&&(e.$message({message:"重置成功！",type:"success"}),e.search(),e.getParentMenu())})},getParentMenu:function(){var e=this;r.a.getParentMenu({partyschoolId:this.reportID}).then(function(t){var n=t.result;e.parentOptions=[],n&&(n.forEach(function(e){e.label=e.menuName,e.value=e.id}),e.parentOptions=n)})},getMenuUrl:function(){var e=this;r.a.getMenuUrl({type:"5",partyschoolId:this.partyschoolId}).then(function(t){var n=t.result;e.options=[],n&&(n.forEach(function(e){e.label=e.name,e.value=e.id}),e.options=n)})},objectSpanMethod:function(e){e.row,e.column;var t=e.rowIndex;if(0===e.columnIndex)return t%5==0?{rowspan:5,colspan:1}:{rowspan:0,colspan:0}},goBack:function(){this.$router.push("/layOut/wechat?currentPage="+this.$route.query.currentPage)}},created:function(){this.reportID=this.$route.query.reportID,this.partyschoolId=this.$route.query.partyschoolId,this.search(),this.getParentMenu(),this.getMenuUrl()},components:{commonBread:a.a}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"weBor"},[n("div",{staticClass:"crumbs"},[n("common-bread")],1),e._v(" "),n("div",{staticClass:"user"},[n("p",{staticClass:"titleBar"},[e._v("\n      自定义菜单\n    ")]),e._v(" "),n("div",{staticClass:"menuBor"},[e._m(0),e._v(" "),n("div",{staticClass:"newsBor"},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"父级菜单 :",prop:"menuParent"}},[n("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form.menuParent,callback:function(t){e.$set(e.form,"menuParent",t)},expression:"form.menuParent"}},e._l(e.parentOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),n("span",{staticClass:"hint"},[e._v("二级菜单必须要选择父菜单")])],1),e._v(" "),e.form.menuParent?n("el-form-item",{attrs:{label:"菜单名称 :",prop:"menuName"}},[n("el-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|menuName2",expression:"'required|menuName2'"}],class:{input:!0,"is-danger":e.errors.has("menuNameA")},attrs:{name:"menuNameA"},model:{value:e.form.menuName,callback:function(t){e.$set(e.form,"menuName",t)},expression:"form.menuName"}}),e._v(" "),n("span",{staticClass:"hint"},[e._v("二级菜单最多7个汉字")]),e._v(" "),n("p",{staticClass:"hints"},[e._v(" "+e._s(e.errors.first("menuNameA"))+" ")])],1):n("el-form-item",{attrs:{label:"菜单名称 :",prop:"menuName"}},[n("el-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|menuName",expression:"'required|menuName'"}],class:{input:!0,"is-danger":e.errors.has("menuNameA")},attrs:{name:"menuNameA"},model:{value:e.form.menuName,callback:function(t){e.$set(e.form,"menuName",t)},expression:"form.menuName"}}),e._v(" "),n("span",{staticClass:"hint"},[e._v("一级菜单最多4个汉字")]),e._v(" "),n("p",{staticClass:"hints"},[e._v(" "+e._s(e.errors.first("menuNameA"))+" ")])],1),e._v(" "),this.form.menuParent?n("el-form-item",{attrs:{label:"菜单功能 :",prop:"menuUrl"}},[n("el-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{input:!0,"is-danger":e.errors.has("menuUrlA")},attrs:{clearable:"",filterable:"",placeholder:"请选择",name:"menuUrlA"},model:{value:e.form.menuUrl,callback:function(t){e.$set(e.form,"menuUrl",t)},expression:"form.menuUrl"}},e._l(e.options,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),n("p",{staticClass:"hints"},[e._v(" "+e._s(e.errors.first("menuUrlA"))+" ")])],1):e._e(),e._v(" "),n("el-form-item",{staticClass:"save"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.save("form")}}},[e._v("保 存")]),e._v(" "),n("el-button",{staticStyle:{"margin-left":"60px"},on:{click:e.goBack}},[e._v("返 回")])],1)],1)],1),e._v(" "),n("div",{staticClass:"menuTable"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.menuData}},[n("el-table-column",{attrs:{type:"index",align:"center",width:"50"}}),e._v(" "),n("el-table-column",{attrs:{prop:"firstMenu",label:"一级菜单","show-overflow-tooltip":"",align:"center",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{label:"二级菜单",align:"center"}},[n("el-table-column",{attrs:{prop:"oneMenu",label:"一","show-overflow-tooltip":"",align:"center",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"twoMenu",label:"二","show-overflow-tooltip":"",align:"center",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"threeMenu",label:"三","show-overflow-tooltip":"",align:"center",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"fourMenu",label:"四","show-overflow-tooltip":"",align:"center",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"fiveMenu",label:"五","show-overflow-tooltip":"",align:"center",width:"120"}})],1)],1)],1),e._v(" "),n("div",{staticClass:"release"},[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("发布自定义菜单")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置自定义菜单")])],1)])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ol",{staticClass:"warning"},[n("li",[e._v("1. 使用本模块生产微信端，必须在微信公众平台申请自定义菜单使用的AppId和AppSecret，即在党校平台中获得授权。")]),e._v(" "),n("li",[e._v("2. 微信端最多创建3个一级菜单，每个一级菜单下最多可以创建5个二级菜单，菜单最多支持两层。（多出部分会生成前3个一级菜单）")]),e._v(" "),n("li",[e._v("3. 主菜单最多4个汉字，子菜单最多7个汉字，多出来的部分将会以“...”代替。")]),e._v(" "),n("li",[e._v("4. 同步自定义菜单后，由于微信客户端缓存，最长需24小时微信客户端才会展现，建议尝试取消关注公众账号后再次关注，则可看到效果。")]),e._v(" "),n("li",[e._v("5. 已通过党校平台绑定相应微信公众号，如果您绑定的是订阅号，自定义菜单不可用。")]),e._v(" "),n("li",[e._v("6. 添加自定义菜单的二级菜单时一定要选择父级菜单选项，直接添加默认为一级菜单。")])])}]};var l=n("C7Lr")(o,s,!1,function(e){n("Xk1i")},"data-v-6dd2dd08",null);t.default=l.exports},Xk1i:function(e,t){}});
//# sourceMappingURL=8.dc9f24359450bcdae70a.js.map