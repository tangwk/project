webpackJsonp([44],{"+tRl":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Osha"),o=a("lK/u"),n={name:"VideoSectionLook",data:function(){return{artSecTitle:this.$route.query.columnName,numberTop:"",videoName:"",videoTopData:[],videoSData:[],deleteType:"",multipleSelection:[],currentPage:1,total:null,alertClosed:!1,editorFlag:!1}},watch:{videoName:function(e){""===e&&this.search()}},methods:{editor:function(){var e=this;this.editorFlag=!0,this.$nextTick(function(){e.$refs.inputName.focus()})},editorBlur:function(){var e=this;o.a.updateColumn({id:this.$route.query.reportID,columnName:this.artSecTitle,columnType:"2"}).then(function(t){200==t.code&&(e.editorFlag=!1,e.$message({message:"修改成功!",type:"success"}))})},search:function(){var e=this;this.videoSData=[],o.a.getColumnVideo({type:"1",id:"",columnId:this.reportID,columnName:"",videoName:this.videoName,partyschoolId:"",videoContent:"",startDate:"",endDate:"",pageNum:this.currentPage,pageSize:10}).then(function(t){var a=t.result;if(200===t.code){e.artSecTitle=a[0].columnName;a.forEach(function(t){var a={};a.videoName=t.videoName,a.videoTime=e.formatDate(t.uploadDate),a.videoSource=t.mappingUrl,a.reportID=t.id,a.mark=t.mark,a.videoOrder=t.videoOrder,"0"===t.mark&&e.videoSData.push(a)})}else 900===t.code&&(e.currentPage>1?(e.currentPage=e.currentPage-1,e.search()):e.videoSData=[]);t.number&&(e.total=t.number)}).catch(function(e){}),this.videoTopData=[],o.a.getColumnTopVideo({type:"1",id:"",columnId:this.reportID,columnName:"",videoName:this.videoName,partyschoolId:"",videoContent:"",startDate:"",endDate:""}).then(function(t){var a=t.result;if(200===t.code){e.numberTop=t.number+1,e.artSecTitle=a[0].columnName;a.forEach(function(t){var a={};a.videoName=t.videoName,a.videoTime=e.formatDate(t.uploadDate),a.videoSource=t.mappingUrl,a.reportID=t.id,a.mark=t.mark,a.videoOrder=t.videoOrder,"1"===t.mark&&e.videoTopData.push(a)})}else 900===t.code&&(e.numberTop=1)})},handleSelectionChange:function(e){this.multipleSelection=e},deleteAll:function(){var e=this,t=[];this.multipleSelection.map(function(e){var a={};a.videoId=e.reportID,t.push(a)}),o.a.deleteColumnVideo({columnId:this.reportID,data:t,status:0}).then(function(t){200===t.code&&(e.alertClosed=!e.alertClosed,e.$message({message:"删除成功！",type:"success"}),e.search())})},deleteSingle:function(){var e=this;o.a.deleteColumnVideo({columnId:this.reportID,data:[{videoId:this.currentDelId}],status:0}).then(function(t){200===t.code&&(e.alertClosed=!e.alertClosed,e.$message({message:"删除成功！",type:"success"}),e.search())})},checkDel:function(){this.alertClosed=!this.alertClosed,this.deleteType="deleteAll"},handleDel:function(e,t){this.currentDelId=t.reportID,this.alertClosed=!this.alertClosed,this.deleteType="deleteSingle"},sureDel:function(){"deleteAll"===this.$refs.deleteRef.getAttribute("data-type")?this.deleteAll():this.deleteSingle()},close:function(){this.alertClosed=!this.alertClosed},handleDetails:function(e,t){this.$router.push("vslDetails?reportID="+t.reportID)},handleIstop:function(e,t){var a=this;o.a.updateVideoMark({id:t.reportID,mark:"1",videoOrder:this.numberTop}).then(function(e){"0"===t.mark&&a.search()})},handleUnstick:function(e,t){var a=this;o.a.updateVideoMark({id:t.reportID,mark:"0",videoOrder:"999"}).then(function(i){if("1"===t.mark){a.videoTopData.splice(e,1);for(var n=1;n<=a.videoTopData.length;n++)a.videoTopData[n-1].sort=n,o.a.updateVideoMark({id:a.videoTopData[n-1].reportID,mark:"1",videoOrder:n}).then(function(e){});a.search()}})},handleUp:function(e,t){var a=this,i=[];this.videoTopData.forEach(function(t,a){a===e?i.push({id:t.reportID,videoOrder:e}):a===e-1?i.push({id:t.reportID,videoOrder:e+1}):i.push({id:t.reportID,videoOrder:a+1})}),0!=e?o.a.updateVideoOrder({data:i}).then(function(i){a.videoTopData.splice(e-1,0,t),a.videoTopData.splice(e+1,1)}):this.$message({message:"到顶啦！",type:"warning"})},handleDown:function(e,t){var a=this,i=[];this.videoTopData.forEach(function(t,a){a===e?i.push({id:t.reportID,videoOrder:e+2}):a===e+1?i.push({id:t.reportID,videoOrder:e+1}):i.push({id:t.reportID,videoOrder:a+1})}),e!==this.videoTopData.length-1?o.a.updateVideoOrder({data:i}).then(function(i){a.videoTopData.splice(e+2,0,t),a.videoTopData.splice(e,1)}):this.$message({message:"已到底！",type:"warning"})},handleCurrentChange:function(e){this.currentPage=e,this.search()},formatDate:function(e){var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var o=t.getDate();return a+"-"+i+"-"+(o=o<10?"0"+o:o)+" "}},created:function(){this.reportID=this.$route.query.reportID,this.search()},components:{commonBread:i.a}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"boxBor"},[a("div",{staticClass:"crumbs"},[a("common-bread")],1),e._v(" "),a("div",{staticClass:"user"},[a("p",{staticClass:"titleBar"},[e._v("\n        视频栏目查看\n      ")]),e._v(" "),a("div",{staticClass:"userListBor"},[a("div",{staticStyle:{"text-align":"center"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.editorFlag,expression:"!editorFlag"}],staticStyle:{"font-size":"20px"},attrs:{for:""},domProps:{textContent:e._s(this.artSecTitle)}}),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.editorFlag,expression:"editorFlag"}],ref:"inputName",staticClass:"artSecTitle",staticStyle:{width:"200px"},on:{blur:e.editorBlur},model:{value:e.artSecTitle,callback:function(t){e.artSecTitle=t},expression:"artSecTitle"}}),e._v(" "),a("i",{staticClass:"el-icon-edit-outline",staticStyle:{"font-size":"20px",cursor:"pointer"},on:{click:e.editor}})],1),e._v(" "),a("div",{staticClass:"userList clear"},[a("div",{staticClass:"actBtn left"},[a("button",{staticClass:"newAdd",attrs:{disabled:0==e.multipleSelection.length},on:{click:e.checkDel}},[e._v("批量删除")])]),e._v(" "),a("ul",{staticClass:"fillIn right"},[a("li",[e._m(0),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.videoName,expression:"videoName"}],attrs:{type:"text",size:"small",name:"keyword",placeholder:"按视频名称搜索"},domProps:{value:e.videoName},on:{input:function(t){t.target.composing||(e.videoName=t.target.value)}}})]),e._v(" "),a("li",[a("button",{on:{click:e.search}},[e._v("搜 索")])])])]),e._v(" "),a("div",{staticClass:"bgTop"},[a("el-table",{ref:"singleTable",attrs:{data:e.videoTopData,"max-height":"287","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"置顶区",width:"80px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"videoName",label:"视频名称","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"videoTime",label:"上传时间","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"videoSource",label:"映射地址","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"iconfont icon-xiangqing",staticStyle:{color:"#79ac88"},attrs:{title:"详情"},on:{click:function(a){e.handleDetails(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-shangyi",staticStyle:{color:"#0089cc"},attrs:{title:"上移"},on:{click:function(a){e.handleUp(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-shangyi-copy",staticStyle:{color:"#0089cc"},attrs:{title:"下移"},on:{click:function(a){e.handleDown(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-quxiaozhiding",staticStyle:{color:"#e82121"},attrs:{title:"取消置顶"},on:{click:function(a){e.handleUnstick(t.$index,t.row)}}})]}}])})],1)],1),e._v(" "),a("el-table",{ref:"singleTable",attrs:{data:e.videoSData,"highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"80px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"videoName",label:"视频名称","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"videoTime",label:"上传时间","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"videoSource",label:"映射地址","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"iconfont icon-xiangqing",attrs:{title:"详情"},on:{click:function(a){e.handleDetails(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-zhiding",attrs:{title:"置顶"},on:{click:function(a){e.handleIstop(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-shanchu-copy",attrs:{title:"删除"},on:{click:function(a){e.handleDel(t.$index,t.row)}}})]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.alertClosed,expression:"alertClosed"}],staticClass:"dataDel"},[a("div",{staticClass:"sureDel"},[a("div",{staticClass:"titleDel"},[a("p",[e._v("确认删除")]),e._v(" "),a("i",{staticClass:"iconfont icon-guanbi",on:{click:e.close}})]),e._v(" "),a("h3",[e._v("确定要把所选视频进行删除吗？")]),e._v(" "),a("p",[a("button",{ref:"deleteRef",attrs:{"data-type":e.deleteType},on:{click:e.sureDel}},[e._v("确定")]),e._v(" "),a("button",{on:{click:e.close}},[e._v("取消")])])]),e._v(" "),a("div",{staticClass:"opacityDel"})])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("label",{attrs:{for:"keyword"}},[this._v("\n                    关"),t("span",{staticStyle:{margin:"0 0.5em"}},[this._v("键")]),t("span",{staticStyle:{"margin-right":"0.5em"}},[this._v("字 : ")])])}]};var l=a("C7Lr")(n,r,!1,function(e){a("AadJ")},"data-v-1fec8d46",null);t.default=l.exports},AadJ:function(e,t){}});
//# sourceMappingURL=44.4514d11dd74d7dd48902.js.map