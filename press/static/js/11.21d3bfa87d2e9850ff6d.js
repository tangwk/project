webpackJsonp([11],{"jk+L":function(e,t){},"lf+w":function(e,t,a){"use strict";var s=a("JVB/");var l={getMapList:function(e){return Object(s.a)({url:"/findMapping",method:"post",data:e})},deleteMap:function(e){return Object(s.a)({url:"/deleteMapping",method:"post",data:e})},addMap:function(e){return Object(s.a)({url:"/saveMapping",method:"post",data:e})},updateMap:function(e){return Object(s.a)({url:"/updateMapping",method:"post",data:e})},generateMapUrl:function(e){return Object(s.a)({url:"/findShortUrl",method:"post",data:e})},getVideoMapUrl:function(e){return Object(s.a)({url:"/findVideoMappingById",method:"post",data:e})}};t.a=l},qcJ4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Osha"),l=a("lf+w"),r=a("/dSo"),i=a.n(r),n={name:"Map",data:function(){return{mapsName:"",sourceAddress:"",mapAddress:"",dialogVisible:!1,mapName:"",mapData:[],deleteType:"",multipleSelection:[],currentPage:1,total:null,alertClosed:!1}},watch:{mapName:function(e){""===e&&this.search()}},methods:{copy:function(){var e=this,t=new i.a(".tag-read");t.on("success",function(a){e.$message({message:"复制成功!",type:"success"}),t.destroy()}),t.on("error",function(e){t.destroy()})},searchData:function(){this.mapData=[],this.currentPage=1,this.search()},search:function(){var e=this;this.mapData=[],l.a.getMapList({id:"",partyschoolId:"",videoName:this.mapName,mappingUrl:"",pageNum:this.currentPage,pageSize:10}).then(function(t){var a=t.result;if(200===t.code){a.forEach(function(e){e.mapName=e.videoName,e.sourceAddress=e.realUrl,e.mapAddress=e.mappingUrl,e.reportID=e.id}),e.mapData=a;for(var s=0;s<e.mapData.length;s++)9==s?e.mapData[s].num=e.currentPage+"0":1==e.currentPage?e.mapData[s].num=e.currentPage+s+"":e.mapData[s].num=e.currentPage-1+""+(s+1)}else 900===t.code&&(e.currentPage>1?(e.currentPage=e.currentPage-1,e.search()):e.mapData=[]);t.number&&(e.total=t.number)})},handleSelectionChange:function(e){this.multipleSelection=e},deleteAll:function(){var e=this,t=[];this.multipleSelection.map(function(e){var a={};a.id=e.id,t.push(a)}),l.a.deleteMap({data:t,status:0}).then(function(t){200===t.code&&(e.alertClosed=!e.alertClosed,e.$message({message:"删除成功！",type:"success"}),e.search())})},deleteSingle:function(){var e=this;l.a.deleteMap({data:[{id:this.currentDelId}],status:0}).then(function(t){200===t.code&&(e.alertClosed=!e.alertClosed,e.$message({message:"删除成功！",type:"success"}),e.search())})},checkDel:function(){this.alertClosed=!this.alertClosed,this.deleteType="deleteAll"},handleDel:function(e,t){this.currentDelId=t.reportID,this.alertClosed=!this.alertClosed,this.deleteType="deleteSingle"},sureDel:function(){"deleteAll"===this.$refs.deleteRef.getAttribute("data-type")?this.deleteAll():this.deleteSingle()},close:function(){this.alertClosed=!this.alertClosed},handleDetails:function(e,t){this.$router.push({name:"MapDetails",query:{reportID:t.reportID,currentPage:this.currentPage}})},createMap:function(e){var t=this;this.$validator.validate("relUrl").then(function(e){e&&l.a.generateMapUrl({realUrl:t.sourceAddress}).then(function(e){200===e.code&&(t.mapAddress=e.result)})})},mapSave:function(){var e=this;this.$validator.validateAll().then(function(t){t&&l.a.addMap({partyschoolId:"",videoName:e.mapsName,mappingUrl:e.mapAddress,realUrl:e.sourceAddress}).then(function(t){e.dialogVisible=!1,e.$message({message:"保存成功！",type:"success"}),e.search(),e.mapsName="",e.mapAddress="",e.sourceAddress=""})})},mapBack:function(){this.dialogVisible=!1,this.mapsName="",this.mapAddress="",this.sourceAddress=""},handleCurrentChange:function(e){this.currentPage=e,this.search()},handleClose:function(e){e()}},created:function(){this.$route.query.currentPage&&(this.currentPage=Number(this.$route.query.currentPage)),this.search()},components:{commonBread:s.a}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"boxBor"},[a("div",{staticClass:"crumbs"},[a("common-bread")],1),e._v(" "),a("div",{staticClass:"user"},[a("p",{staticClass:"titleBar"},[e._v("\n        映射管理\n      ")]),e._v(" "),a("div",{staticClass:"userListBor"},[a("div",{staticClass:"userList clear"},[a("div",{staticClass:"actBtn left"},[a("button",{staticClass:"newAdd",on:{click:function(t){e.dialogVisible=!0}}},[e._v("映 射")])]),e._v(" "),a("ul",{staticClass:"fillIn right"},[a("li",[e._m(0),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.mapName,expression:"mapName"}],attrs:{type:"text",size:"small",name:"keyword",placeholder:"按视频名称搜索"},domProps:{value:e.mapName},on:{input:function(t){t.target.composing||(e.mapName=t.target.value)}}})]),e._v(" "),a("li",[a("button",{on:{click:e.searchData}},[e._v("搜 索")])])])]),e._v(" "),a("el-table",{ref:"singleTable",attrs:{data:e.mapData,"highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{property:"num",label:"序号","show-overflow-tooltip":"",width:"80px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"mapName",label:"视频名称","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"sourceAddress",label:"来源地址","show-overflow-tooltip":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"映射地址",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{placement:"bottom"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("点击复制")]),e._v(" "),a("span",{staticClass:"tag-read",staticStyle:{display:"block",cursor:"pointer",width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},attrs:{"data-clipboard-text":e.mapData[t.$index].mappingUrl},on:{click:e.copy}},[e._v(e._s(e.mapData[t.$index].mappingUrl))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"iconfont icon-xiangqing",attrs:{title:"详情"},on:{click:function(a){e.handleDetails(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-shanchu-copy",attrs:{title:"删除"},on:{click:function(a){e.handleDel(t.$index,t.row)}}})]}}])})],1),e._v(" "),e.total>1?a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:"映射地址",visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("ul",{staticClass:"mapInputBor"},[a("li",[a("label",{attrs:{for:"mapName"}},[e._v("视频名称 :")]),e._v(" "),a("el-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mapInput",class:{input:!0,"is-danger":e.errors.has("mapName")},attrs:{id:"mapName",placeholder:"请输入视频名称",name:"mapName"},model:{value:e.mapsName,callback:function(t){e.mapsName=t},expression:"mapsName"}}),e._v(" "),a("p",{staticClass:"hint"},[e._v(" "+e._s(e.errors.first("mapName"))+" ")])],1),e._v(" "),a("li",[a("label",{attrs:{for:"source"}},[e._v("来源地址 :")]),e._v(" "),a("el-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|url",expression:"'required|url'"}],staticClass:"mapInput",class:{input:!0,"is-danger":e.errors.has("relUrl")},attrs:{id:"source",placeholder:"请输入真实地址",name:"relUrl"},on:{blur:e.createMap},model:{value:e.sourceAddress,callback:function(t){e.sourceAddress=t},expression:"sourceAddress"}}),e._v(" "),a("p",{staticClass:"hint"},[e._v(" "+e._s(e.errors.first("relUrl"))+" ")])],1),e._v(" "),a("li",[a("label",{attrs:{for:"maps"}},[e._v("映射地址 :")]),e._v(" "),a("el-input",{staticClass:"mapInput",attrs:{id:"maps",placeholder:"请输入映射地址",readonly:"",name:"mapUrl"},model:{value:e.mapAddress,callback:function(t){e.mapAddress=t},expression:"mapAddress"}})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer submit",attrs:{slot:"footer"},slot:"footer"},[a("button",{on:{click:e.mapSave}},[e._v("保 存")]),e._v(" "),a("button",{on:{click:e.mapBack}},[e._v("取 消")])])])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.alertClosed,expression:"alertClosed"}],staticClass:"dataDel"},[a("div",{staticClass:"sureDel"},[a("div",{staticClass:"titleDel"},[a("p",[e._v("确认删除")]),e._v(" "),a("i",{staticClass:"iconfont icon-guanbi",on:{click:e.close}})]),e._v(" "),a("h3",[e._v("确定要把所选映射进行删除吗？")]),e._v(" "),a("p",[a("button",{ref:"deleteRef",attrs:{"data-type":e.deleteType},on:{click:e.sureDel}},[e._v("确定")]),e._v(" "),a("button",{on:{click:e.close}},[e._v("取消")])])]),e._v(" "),a("div",{staticClass:"opacityDel"})])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("label",{attrs:{for:"keyword"}},[t("span",{staticStyle:{display:"inline-block",width:"0.2rem"}}),this._v("关\n                              "),t("span",{staticStyle:{display:"inline-block",width:"0.26rem"}}),this._v("键\n                              "),t("span",{staticStyle:{display:"inline-block",width:"0.26rem"}}),this._v("字 :\n                              "),t("span",{staticStyle:{display:"inline-block",width:"0.18rem"}})])}]};var c=a("C7Lr")(n,o,!1,function(e){a("jk+L")},"data-v-e30dc202",null);t.default=c.exports}});
//# sourceMappingURL=11.21d3bfa87d2e9850ff6d.js.map