webpackJsonp([25],{"1bRC":function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=l("Osha"),a=l("ymeN"),i={name:"Message",data:function(){return{msgTitle:"",messageData:[],deleteType:"",multipleSelection:[],currentPage:1,total:null,alertClosed:!1}},watch:{msgTitle:function(e){""===e&&this.search()}},methods:{search:function(){var e=this;a.a.getMessageList({id:"",title:this.msgTitle,pageNum:this.currentPage,pageSize:10}).then(function(t){console.log(t);var l=t.result;l&&(l.forEach(function(t){t.msgTitle=t.title,t.sendTime=e.formatDate(t.releaseDate),t.publisher=t.releaseName,t.reportID=t.id}),e.messageData=l),t.number&&(e.total=t.number)}).catch(function(e){})},handleSelectionChange:function(e){this.multipleSelection=e},deleteAll:function(){var e=this,t=[];this.multipleSelection.map(function(e){var l={};l.id=e.id,t.push(l)}),a.a.deleteMessage({data:t,status:0}).then(function(t){"200"===t.code&&(e.alertClosed=!e.alertClosed),e.$message({message:"删除成功！",type:"success"}),e.search()})},deleteSingle:function(){var e=this;a.a.deleteMessage({data:[{id:this.currentDelId}],status:0}).then(function(t){e.alertClosed=!e.alertClosed,"200"===t.code&&e.items.forEach(function(t,l){t.reportID===e.currentDelId&&(e.items.splice(l,1),e.total--)}),e.$message({message:"删除成功！",type:"success"}),e.search()})},checkDel:function(){this.alertClosed=!this.alertClosed,this.deleteType="deleteAll"},handleDel:function(e,t){this.currentDelId=t.reportID,this.alertClosed=!this.alertClosed,this.deleteType="deleteSingle"},sureDel:function(){"deleteAll"===this.$refs.deleteRef.getAttribute("data-type")?this.deleteAll():this.deleteSingle()},close:function(){this.alertClosed=!this.alertClosed},handleLook:function(e,t){this.$router.push("msgLook?reportID="+t.reportID)},publish:function(){this.$router.push("publishNews?reportID")},handleCurrentChange:function(e){this.currentPage=e,this.search()},formatDate:function(e){var t=new Date(e),l=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;var a=t.getDate();return l+"-"+s+"-"+(a=a<10?"0"+a:a)+" "}},created:function(){this.search()},components:{commonBread:s.a}},n={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"messageBor"},[l("div",{staticClass:"crumbs"},[l("common-bread")],1),e._v(" "),l("div",{staticClass:"user"},[l("p",{staticClass:"titleBar"},[e._v("\n      消息中心\n    ")]),e._v(" "),l("div",{staticClass:"userListBor"},[l("div",{staticClass:"userList clear"},[l("div",{staticClass:"actBtn left"},[l("button",{staticClass:"newAdd",on:{click:e.publish}},[e._v("发布消息")]),e._v(" "),l("button",{staticClass:"newAdd",attrs:{disabled:0==e.multipleSelection.length},on:{click:e.checkDel}},[e._v("批量删除")])]),e._v(" "),l("ul",{staticClass:"fillIn right"},[l("li",[e._m(0),e._v(" "),l("input",{directives:[{name:"model",rawName:"v-model",value:e.msgTitle,expression:"msgTitle"}],attrs:{type:"text",size:"small",name:"keyword",placeholder:"按标题搜索"},domProps:{value:e.msgTitle},on:{input:function(t){t.target.composing||(e.msgTitle=t.target.value)}}})]),e._v(" "),l("li",[l("button",{on:{click:e.search}},[e._v("搜 索")])])])]),e._v(" "),l("el-table",{ref:"singleTable",attrs:{data:e.messageData,"highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{width:"80",align:"center",type:"selection"}}),e._v(" "),l("el-table-column",{attrs:{property:"msgTitle",label:"消息标题",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{property:"sendTime",label:"发布时间",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{property:"publisher",label:"发布人",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("i",{staticClass:"iconfont icon-yanjing-copy",attrs:{title:"查看"},on:{click:function(l){e.handleLook(t.$index,t.row)}}}),e._v(" "),l("i",{staticClass:"iconfont icon-shanchu-copy",attrs:{title:"删除"},on:{click:function(l){e.handleDel(t.$index,t.row)}}})]}}])})],1),e._v(" "),e.total>1?l("div",{staticClass:"block"},[l("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1):e._e()],1)]),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:e.alertClosed,expression:"alertClosed"}],staticClass:"dataDel"},[l("div",{staticClass:"sureDel"},[l("div",{staticClass:"titleDel"},[l("p",[e._v("确认删除")]),e._v(" "),l("i",{staticClass:"iconfont icon-guanbi",on:{click:e.close}})]),e._v(" "),l("h3",[e._v("确定要把所选消息进行删除吗？")]),e._v(" "),l("p",[l("button",{ref:"deleteRef",attrs:{"data-type":e.deleteType},on:{click:e.sureDel}},[e._v("确定")]),e._v(" "),l("button",{on:{click:e.close}},[e._v("取消")])])]),e._v(" "),l("div",{staticClass:"opacityDel"})])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("label",{attrs:{for:"keyword"}},[t("span",{staticStyle:{display:"inline-block",width:"0.2rem"}}),this._v("关\n              "),t("span",{staticStyle:{display:"inline-block",width:"0.26rem"}}),this._v("键\n              "),t("span",{staticStyle:{display:"inline-block",width:"0.26rem"}}),this._v("字 :\n              "),t("span",{staticStyle:{display:"inline-block",width:"0.18rem"}})])}]};var r=l("C7Lr")(i,n,!1,function(e){l("JWeS")},"data-v-62f0595a",null);t.default=r.exports},JWeS:function(e,t){}});
//# sourceMappingURL=25.6cf72eaf3506bfaa0572.js.map